---
title: "ign2map : Du site à la carte"
authors: ["Florian Boret, Julien Moura"]
categories: ["article"]
date: 2021-02-10 11:11
description: ""
image: ""
tags: bash,ign,leaflet
---

# ign2map : Du site à la carte

:calendar: Date de publication initiale : 10 Février 2021

**Mots-clés :** bash | IGN | leaflet

## How it started

CAPTURE DU SLACK - QUESTION PLUS REPONSE DE JU

Le 18 Janvier dans les coulisses de GéoTribu :shushing_face:

Sur le papier, la solution proposée paraissait relativement simple mais pour corser le tout on a décidé :

- De travailler en Bash
- De se répartir les tâches de la manière suivante :
    - @Flo sur la construction des scripts
    - @Ju l’enchainement des scripts et sur le déploiement

## 6 étapes pour arriver à la carte

### Scraping du site de l'IGN

### Extraction des fichiers par département, région et pour la France

### Nettoyage des liens (format, doublons)

### Mise en forme des données avant jointure

### Jointure avec les topojson

### Création automatique du fichier index.html


----

## Le déploiement

![icône GitHub Actions](https://cdn.geotribu.fr/img/logos-icones/divers/github_actions.png "GitHub Actions"){: .img-rdp-news-thumb }

L'IGN ayant annoncé que l'ouverture serait progressive, on anticipe que la page est donc appelée à s'agrandir (sic). Pour que le projet ne soit pas un symbôle d'obsolescence programmée, on choisit donc d'automatiser le processus via [Github Actions] et la publication sur [Github Pages].

A l'instar de la plupart des plateformes d'intégration et de déploiement continus (_CI_ et _CD_ pour les intimes des acronymes anglophones), cela consiste à décrire le processus (_workflow_ dans la terminologie GitHub) dans la syntaxe [YAML].

Le [fichier complet est dans le dépôt](https://github.com/geotribu/ign-fr-opendata-download-ui/blob/main/.github/workflows/run_n_publish.yml) mais prenons ici le temps de détailler les étapes.

### Conditions d'exécution

Tout d'abord, on indique les critères de déclenchement du processus. On a choisi de concilier deux cas de figure :

- une exécution récurrente sur une base mensuelle, le permier jour de chaque mois
- une exécution manuelle pour nos tests ou quand l'envie nous prend

On souhaite également déclencher l'exécution uniquement lorsque des modifications sont appliquées sur la branche principale du projet.

Voici ce que cela donne :

```yaml
on:
  schedule:
    - cron: "0 0 1 * *"  # exécution planifiée le premier jour de chaque mois
  workflow_dispatch:     # permet de déclencher manuellement (ici sans passer aucun paramètre particulier)
  push:
    branches: [ main ]
    paths:
      - '.github/workflows/run_n_publish.yml'
```

### L'environnement d'exécution

Vu que notre outil est écrit en bash, une surcouche du monde Linux au Shell, on opte pour Ubuntu :


```yaml

```

### Les étapes

Ici on décrit juste nos principales étapes :


```yaml
# exécution du script

# publication

```



----

## La publication et les chiffres

On doit avouer que le couvre-feu, nous a un peu aidé car il ne nous aura fallu que 15 jours pour arriver au résultat publié.

CAPTURE DE RETWEET DE L’IGN

Est-ce qu’on parle de la discussion avec le DG?

----

## Auteurs

--8<-- "content/team/fbor.md"

--8<-- "content/team/jmou.md"

<!-- Hyperlinks reference -->
[GitHub Actions]: https://github.com/features/actions
[GitHub Pages]: https://guides.github.com/features/pages/
[YAML]: https://fr.wikipedia.org/wiki/YAML
